heavily drawn from https://github.com/bshall/ZeroSpeech and https://github.com/openai/jukebox